(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{3730:function(e,t,s){Promise.resolve().then(s.bind(s,7943))},7943:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var n=s(7437),a=s(2265),i=s(2749),o=s(4033),r=s(1396),d=s.n(r);function Dashboard(){let{data:e,status:t}=(0,i.useSession)(),s=(0,o.useRouter)(),[r,l]=(0,a.useState)([]),[c,p]=(0,a.useState)(!0),[u,x]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[k,f]=(0,a.useState)(""),[j,m]=(0,a.useState)("all"),[b,v]=(0,a.useState)(1),[y,w]=(0,a.useState)(1),[N,C]=(0,a.useState)(!1),handleLogout=async()=>{C(!0),await (0,i.signOut)({redirect:!1}),s.push("/"),s.refresh()};(0,a.useEffect)(()=>{"unauthenticated"===t&&s.push("/login")},[t,s]),(0,a.useEffect)(()=>{e&&fetchTasks()},[e,k,j,b]);let fetchTasks=async()=>{try{let e=new URLSearchParams;k&&e.append("search",k),"all"!==j&&e.append("status",j),e.append("page",b),e.append("limit","5");let t=await fetch("/api/tasks?".concat(e));if(t.ok){let e=await t.json();l(e.tasks||[]),w(e.pagination.pages)}else{let e=await t.json();x(e.error||"Failed to fetch tasks")}}catch(e){console.error("Error fetching tasks:",e),x("Network error. Please try again.")}finally{p(!1)}},handleDelete=async e=>{if(confirm("Are you sure you want to delete this task?"))try{let t=await fetch("/api/tasks/".concat(e),{method:"DELETE"});t.ok&&(l(r.filter(t=>t._id!==e)),g("Task deleted successfully"),setTimeout(()=>g(""),3e3))}catch(e){console.error("Error deleting task:",e)}},toggleTaskStatus=async(e,t)=>{try{let s=await fetch("/api/tasks/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"done"===t?"pending":"done"})});s.ok&&l(r.map(t=>t._id===e?{...t,status:"done"===t.status?"pending":"done"}:t))}catch(e){console.error("Error updating task status:",e)}};return"loading"===t||c?(0,n.jsx)("div",{children:"Loading..."}):(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"nav",children:[(0,n.jsx)("h1",{children:"Your Tasks"}),(0,n.jsxs)("div",{className:"nav-actions",children:[(0,n.jsxs)(d(),{href:"/tasks/new",className:"btn btn-primary add-task-btn btn-ripple",children:[(0,n.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add New Task"]}),(0,n.jsx)("button",{onClick:handleLogout,className:"btn logout-btn btn-ripple ".concat(N?"btn-loading":""),disabled:N,children:!N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})]}),u&&(0,n.jsx)("div",{className:"error-message",children:u}),h&&(0,n.jsx)("div",{style:{color:"green",padding:"10px",backgroundColor:"#d1fae5",borderRadius:"5px",marginBottom:"20px"},children:h}),(0,n.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[(0,n.jsx)("input",{type:"text",placeholder:"Search tasks...",value:k,onChange:e=>f(e.target.value),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px",flex:1}}),(0,n.jsxs)("select",{value:j,onChange:e=>m(e.target.value),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,n.jsx)("option",{value:"all",children:"All"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"done",children:"Done"})]})]}),0===r.length?(0,n.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(0,n.jsx)("p",{children:"No tasks yet. Create your first task!"})}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:r.map(e=>(0,n.jsx)("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"5px",backgroundColor:"#fff"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{style:{margin:"0 0 10px 0"},children:e.title}),(0,n.jsx)("p",{style:{margin:"0 0 10px 0",color:"#666"},children:e.description}),(0,n.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,n.jsx)("span",{onClick:()=>toggleTaskStatus(e._id,e.status),style:{cursor:"pointer",marginRight:"10px"},children:"done"===e.status?"✓":"○"}),(0,n.jsx)("span",{style:{padding:"5px 10px",borderRadius:"15px",fontSize:"12px",backgroundColor:"done"===e.status?"#d1fae5":"#fef3c7",color:"done"===e.status?"#065f46":"#92400e"},children:e.status}),(0,n.jsx)("span",{style:{fontSize:"12px",color:"#999"},children:new Date(e.createdAt).toLocaleDateString()})]})]}),(0,n.jsxs)("div",{className:"task-actions",children:[(0,n.jsxs)(d(),{href:"/tasks/edit/".concat(e._id),className:"task-action-btn task-action-edit btn-ripple",children:[(0,n.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,n.jsxs)("button",{onClick:()=>handleDelete(e._id),className:"task-action-btn task-action-delete btn-ripple",children:[(0,n.jsx)("svg",{className:"btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})},e._id))}),y>1&&(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"10px"},children:[(0,n.jsx)("button",{onClick:()=>v(e=>Math.max(e-1,1)),disabled:1===b,style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",cursor:1===b?"not-allowed":"pointer"},children:"Previous"}),(0,n.jsxs)("span",{style:{padding:"8px"},children:["Page ",b," of ",y]}),(0,n.jsx)("button",{onClick:()=>v(e=>Math.min(e+1,y)),disabled:b===y,style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",cursor:b===y?"not-allowed":"pointer"},children:"Next"})]})]})}},1396:function(e,t,s){e.exports=s(8326)},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[749,326,971,472,744],function(){return e(e.s=3730)}),_N_E=e.O()}]);